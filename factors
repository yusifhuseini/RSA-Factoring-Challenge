#!/usr/bin/env bash

factorize() {
    if [ $# -ne 3 ]; then
        args=("$@")
        c=0
        q=1
        for a in "${args[@]}"; do
            if [ $c -gt 1 ]; then
                q=$((a * q))
            fi
            c=$((c + 1))
        done
    else
        q=$3
    fi

    p=$2
    n=${1//:/=}

    if [ "$q" -gt "$p" ]; then
        r=1
    else
        r=0
    fi

    if [ "$r" -eq 1 ]; then
        tmp=$p
        p=$q
        q=$tmp
    fi

    echo "$n$p*$q"
}

if [ $# -ne 1 ]; then
    echo 'Usage: factors <file>'
    exit 1
else
    while read i; do
        r=$(factor "$i")
        factorize $r
    done < "$1"
fi
