#!/usr/bin/env bash

factorize()
{
	if [ $# -ne 3 ];
	then
		args=("$@")
		c=0
		q=1
		for a in ${args[*]};
		do
			if [ $c -gt 1 ];
			then
				q=$(bc <<< "$a * $q")
			fi
			c=$((c + 1))
		done
	else
		q=$3
	fi

	p=$2
	#n=$(echo "$1" | tr ':' '=')
	n=${1//:/=}

	#r=$(echo "if($q > $p) 1 else 0" | bc)
	r=$(awk -v q="$q" -v p="$p" 'BEGIN {if (q > p) print 1; else print 0}')

	if ((r == 1)); then
		tmp=$p
		p=$q
		q=$tmp
	fi

	echo "$n$p*$q"
}

#if [ $# -ne 1 ]
#then
#	echo 'Usage: factors <file>'
#	exit 1
#else
#
#	while read i
#	do
#
#		r=$(factor "$i")
#		factorize $r
#
#	done < "$1"
#fi

if [ $# -ne 1 ]
then
    echo 'Usage: factors <file>'
    exit 1
else
    while read i
    do
        # Check if the input is a positive integer
        if [[ "$i" =~ ^[0-9]+$ ]]
        then
            r=$(factor "$i")
	    factorize $r
        fi
    done < "$1"
fi
