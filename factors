#!/usr/bin/env bash

factorize()
{
	if [ $# -ne 0 ];
	then
		args=("$@")
		c=0
		q=1
		for a in ${args[*]};
		do
			if [ $c -gt 1 ];
			then
				q=$(echo $a*$q | bc)
			fi
			c=$((c + 1))
		done
	else
		q=$3
	fi

	p=$2
	n=$(echo "$1" | tr ':' '=')

	r=$(echo "if($q > $p) 1 else 0" | bc)
		if ((r == 1)); then
			tmp=$p
			p=$q
			q=$tmp
		fi

	echo "$n$p*$q"
}

if [ $# -ne 1 ]
then
	echo 'Usage: factors <file>'
	exit 1
else

	while -r i
	do

		r=$(factor "$i")
		factorize $r

	done < "$1"
fi
